From 3e3860e0ecc9f330c7c0df143641a01073ad976c Mon Sep 17 00:00:00 2001
From: Matthew Barnes <mbarnes@redhat.com>
Date: Wed, 31 Aug 2011 16:30:56 +0000
Subject: Bug 657836 - Work around g_unix_signal API changes.

Work around GLib API churn with regard to registering UNIX signal
callbacks on the main loop.  GLib >= 2.29.5 calls the function one
thing, GLib >= 2.29.19 calls it another.
---
diff --git a/shell/main.c b/shell/main.c
index 95dc1b9..8e1d533 100644
--- a/shell/main.c
+++ b/shell/main.c
@@ -613,7 +613,11 @@ main (gint argc, gchar **argv)
 	}
 
 #ifdef G_OS_UNIX
-#if GLIB_CHECK_VERSION(2,29,5)
+#if GLIB_CHECK_VERSION(2,29,19)
+	g_unix_signal_add_full (
+		G_PRIORITY_DEFAULT, SIGTERM,
+		handle_term_signal, NULL, NULL);
+#elif GLIB_CHECK_VERSION(2,29,5)
 	g_unix_signal_add_watch_full (
 		SIGTERM, G_PRIORITY_DEFAULT,
 		handle_term_signal, NULL, NULL);
--
cgit v0.9.0.2
