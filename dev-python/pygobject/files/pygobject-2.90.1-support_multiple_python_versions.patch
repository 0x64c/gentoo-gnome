From 712f9f95c1bc1a75b5bf877a8cd882760512a84b Mon Sep 17 00:00:00 2001
From: Gilles Dartiguelongue <eva@gentoo.org>
Date: Fri, 8 Apr 2011 15:43:39 +0200
Subject: [PATCH] Enable support to build against multiple version of python

---
 gi/Makefile.am          |    2 +-
 gi/_glib/Makefile.am    |   10 +++++-----
 gi/_gobject/Makefile.am |    2 +-
 3 files changed, 7 insertions(+), 7 deletions(-)

diff --git a/gi/Makefile.am b/gi/Makefile.am
index ee5eb00..86bff1b 100644
--- a/gi/Makefile.am
+++ b/gi/Makefile.am
@@ -27,7 +27,7 @@ _gi_la_LDFLAGS = \
 	-export-symbols-regex "init_gi|PyInit__gi"
 _gi_la_LIBADD = \
 	$(GI_LIBS) \
-	$(top_builddir)/gi/_glib/libpyglib-gi-2.0-@PYTHON_BASENAME@.la
+	$(top_builddir)/gi/_glib/libpyglib-gi-2.0-@PYTHON_BASENAME@@PYTHON_VERSION@.la
 _gi_la_SOURCES = \
 	pygi-repository.c \
 	pygi-repository.h \
diff --git a/gi/_glib/Makefile.am b/gi/_glib/Makefile.am
index fcea61d..013f7ad 100644
--- a/gi/_glib/Makefile.am
+++ b/gi/_glib/Makefile.am
@@ -1,7 +1,7 @@
 AUTOMAKE_OPTIONS = 1.7
 INCLUDES = $(PYTHON_INCLUDES) $(GLIB_CFLAGS) -DPY_SSIZE_T_CLEAN
 
-lib_LTLIBRARIES = libpyglib-gi-2.0-@PYTHON_BASENAME@.la
+lib_LTLIBRARIES = libpyglib-gi-2.0-@PYTHON_BASENAME@@PYTHON_VERSION@.la
 
 pkgpyexecdir = $(pyexecdir)
 
@@ -16,9 +16,9 @@ if PLATFORM_WIN32
 common_ldflags += -no-undefined
 endif
 
-libpyglib_gi_2_0_@PYTHON_BASENAME@_la_CFLAGS = $(GLIB_CFLAGS)
-libpyglib_gi_2_0_@PYTHON_BASENAME@_la_LIBADD = $(GLIB_LIBS) $(FFI_LIBS)
-libpyglib_gi_2_0_@PYTHON_BASENAME@_la_SOURCES = 	\
+libpyglib_gi_2_0_@PYTHON_BASENAME@@PYTHON_VERSION@_la_CFLAGS = $(GLIB_CFLAGS)
+libpyglib_gi_2_0_@PYTHON_BASENAME@@PYTHON_VERSION@_la_LIBADD = $(GLIB_LIBS) $(FFI_LIBS)
+libpyglib_gi_2_0_@PYTHON_BASENAME@@PYTHON_VERSION@_la_SOURCES = 	\
 	pyglib.c		\
 	pyglib.h		\
 	pyglib-private.h 	\
@@ -26,7 +26,7 @@ libpyglib_gi_2_0_@PYTHON_BASENAME@_la_SOURCES = 	\
 
 _glib_la_CFLAGS = $(GLIB_CFLAGS)
 _glib_la_LDFLAGS = $(common_ldflags) -export-symbols-regex "_glib|PyInit__glib"
-_glib_la_LIBADD = $(GLIB_LIBS) $(PYTHON_LIBS) libpyglib-gi-2.0-@PYTHON_BASENAME@.la
+_glib_la_LIBADD = $(GLIB_LIBS) $(PYTHON_LIBS) libpyglib-gi-2.0-@PYTHON_BASENAME@@PYTHON_VERSION@.la
 _glib_la_SOURCES = 	 	\
 	glibmodule.c	 	\
 	pygiochannel.c 	 	\
diff --git a/gi/_gobject/Makefile.am b/gi/_gobject/Makefile.am
index 7e15d4c..a901fe0 100644
--- a/gi/_gobject/Makefile.am
+++ b/gi/_gobject/Makefile.am
@@ -30,7 +30,7 @@ _gobject_la_LIBADD = \
 	$(GLIB_LIBS) \
 	$(FFI_LIBS) \
 	$(PYTHON_LIBS) \
-	$(top_builddir)/gi/_glib/libpyglib-gi-2.0-@PYTHON_BASENAME@.la
+	$(top_builddir)/gi/_glib/libpyglib-gi-2.0-@PYTHON_BASENAME@@PYTHON_VERSION@.la
 
 _gobject_la_SOURCES =           \
         gobjectmodule.c         \
-- 
1.7.6

